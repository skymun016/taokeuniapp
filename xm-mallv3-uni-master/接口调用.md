# 外部系统调用API接口文档

## 概述

本文档专门为其他系统调用本淘客系统提供的商品数据接口。系统已预先采集并保存了淘宝、京东等平台的商品数据，外部系统可通过以下接口获取商品信息、执行搜索和转链操作。

## 基础信息

- **API基础URL**: `https://taokeapi.ymj520.top/api/v1`
- **数据格式**: JSON
- **字符编码**: UTF-8
- **请求方式**: GET/POST
- **认证方式**: 无需认证（内部系统调用）
- **当前数据量**: 淘宝商品约17万+，京东商品约4万+

## 平台标识

| 平台ID | 平台名称 | 说明 |
|--------|----------|------|
| 1 | 淘宝 | 支持淘口令转链 |
| 2 | 京东 | 支持短链转链 |
| 3 | 拼多多 | 部分支持 |

## 快速开始

### 1. 测试API连通性

```bash
# 获取商品列表，验证API是否正常
curl -X GET "https://taokeapi.ymj520.top/api/v1/external/products/all?page=1&page_size=3"
```

### 2. 基本使用流程

1. **获取商品数据** → 2. **选择商品** → 3. **转链推广** → 4. **获得收益**

### 3. 常用接口快速测试

```bash
# 1. 平台搜索商品（重点功能）
# 搜索淘宝商品
curl -X GET "https://taokeapi.ymj520.top/api/v1/products?platform=1&keyword=%E6%89%8B%E6%9C%BA&size=5"

# 搜索京东商品
curl -X GET "https://taokeapi.ymj520.top/api/v1/products?platform=2&keyword=%E6%89%8B%E6%9C%BA&size=5"

# 搜索全平台商品
curl -X GET "https://taokeapi.ymj520.top/api/v1/products?keyword=%E6%89%8B%E6%9C%BA&size=5"

# 2. 按佣金筛选
# 淘宝高佣金商品（佣金率>10%）
curl -X GET "https://taokeapi.ymj520.top/api/v1/products?platform=1&min_commission=10&size=5"

# 京东高佣金商品（佣金率>5%）
curl -X GET "https://taokeapi.ymj520.top/api/v1/products?platform=2&min_commission=5&size=5"

# 3. 获取平台商品列表
curl -X GET "https://taokeapi.ymj520.top/api/v1/external/products/taobao?page=1&page_size=3"
curl -X GET "https://taokeapi.ymj520.top/api/v1/external/products/jd?page=1&page_size=3"

# 4. 生成淘口令（替换为实际的product_id）
curl -X POST "https://taokeapi.ymj520.top/api/v1/external/taobao/taokoling" \
  -H "Content-Type: application/json" \
  -d '{"product_id":"your_product_id_here"}'

# 5. 生成京东短链（替换为实际的product_id）
curl -X POST "https://taokeapi.ymj520.top/api/v1/external/jd/shortlink" \
  -H "Content-Type: application/json" \
  -d '{"product_id":"your_product_id_here"}'
```

## 一、商品数据获取接口

### 1.1 获取全平台商品列表

**接口地址**: `GET /external/products/all`

**功能说明**: 获取系统中已保存的所有平台商品数据，支持多种筛选条件

**请求参数**:
| 参数名 | 类型 | 必填 | 默认值 | 说明 |
|--------|------|------|--------|------|
| page | int | 否 | 1 | 页码，从1开始 |
| page_size | int | 否 | 20 | 每页数量，最大100 |
| platform | int | 否 | - | 平台筛选：1淘宝，2京东，不传返回所有 |
| category_id | int | 否 | - | 分类ID筛选 |
| min_commission_rate | float | 否 | - | 最低佣金比例筛选 |
| max_price | float | 否 | - | 最高价格筛选 |
| keyword | string | 否 | - | 关键词搜索（商品标题） |

**请求示例**:
```bash
# 获取全平台商品列表，前5条
curl -X GET "https://taokeapi.ymj520.top/api/v1/external/products/all?page=1&page_size=5"

# 获取淘宝平台手机相关商品
curl -X GET "https://taokeapi.ymj520.top/api/v1/external/products/all?platform=1&keyword=%E6%89%8B%E6%9C%BA&page=1&page_size=10"
```

**响应格式**:
```json
{
  "success": true,
  "message": "获取商品列表成功",
  "total": 174161,
  "page": 1,
  "page_size": 5,
  "data": [
    {
      "id": 196055,
      "product_id": "DY3AZXviDt5r2mQN83cODdTyUn-zm32N2To0OjPx3gSO",
      "platform": 1,
      "platform_name": "淘宝",
      "title": "直播美衣福利来袭【连衣裙专拍】孤品不退换谨慎下单！",
      "short_title": "直播美衣福利来袭【连衣裙专拍】孤品不退换谨慎下单！",
      "price": 299.0,
      "coupon_price": 299.0,
      "commission_rate": 4.5,
      "commission_amount": 13.46,
      "main_image": "https://img.alicdn.com/bao/uploaded/i1/644620578/O1CN017xvxCi1G8lqcPcdhs_!!644620578.png",
      "category_name": "毛呢外套",
      "shop_name": "FreshMany",
      "sales_volume": 2000,
      "coupon_info": "满0元减0元",
      "coupon_amount": 0.0,
      "profit_amount": 13.46,
      "created_at": "2025-07-20T11:45:11"
    }
  ]
}
```

### 1.2 获取淘宝商品列表

**接口地址**: `GET /external/products/taobao`

**功能说明**: 专门获取淘宝平台的商品数据

**请求参数**:
| 参数名 | 类型 | 必填 | 默认值 | 说明 |
|--------|------|------|--------|------|
| page | int | 否 | 1 | 页码 |
| page_size | int | 否 | 20 | 每页数量 |
| category_id | int | 否 | - | 分类ID |
| min_commission_rate | float | 否 | - | 最低佣金比例 |
| max_price | float | 否 | - | 最高价格 |
| keyword | string | 否 | - | 关键词搜索 |

**请求示例**:
```bash
# 获取淘宝商品，搜索"手机"关键词
curl -X GET "https://taokeapi.ymj520.top/api/v1/external/products/taobao?keyword=%E6%89%8B%E6%9C%BA&page=1&page_size=3"
```

**响应格式**:
```json
{
  "success": true,
  "message": "获取淘宝商品列表成功",
  "total": 296,
  "page": 1,
  "page_size": 3,
  "data": [
    {
      "id": 177487,
      "product_id": "bXMy7mo2Ugtokrp8qzzTNVpHgU6-pD26O6sRr0A2jwwU8",
      "title": "网红爆款吹泡泡的怪女孩美甲贴纸童趣搞怪穿戴甲饰品手机壳diy贴",
      "short_title": "网红爆款吹泡泡的怪女孩美甲贴纸童趣搞怪穿戴甲饰品手机壳diy贴",
      "price": 5.9,
      "coupon_price": 5.9,
      "commission_rate": 4.5,
      "commission_amount": 0.27,
      "main_image": "https://img.alicdn.com/bao/uploaded/i4/2609866314/O1CN01joIPCE1wVrpVUWbCc_!!2609866314.jpg",
      "category_name": "美甲工具",
      "shop_name": "潮际美甲品牌直销店",
      "sales_volume": 200,
      "coupon_info": "满0元减0元",
      "coupon_amount": 0.0,
      "profit_amount": 0.27,
      "created_at": "2025-07-20T10:25:43"
    }
  ]
}

### 1.3 获取京东商品列表

**接口地址**: `GET /external/products/jd`

**功能说明**: 专门获取京东平台的商品数据

**请求参数**: 同淘宝商品列表接口

**请求示例**:
```bash
# 获取京东商品列表
curl -X GET "https://taokeapi.ymj520.top/api/v1/external/products/jd?page=1&page_size=3"
```

**响应格式**:
```json
{
  "success": true,
  "message": "获取京东商品列表成功",
  "total": 43061,
  "page": 1,
  "page_size": 3,
  "data": [
    {
      "id": 186231,
      "product_id": "jvZ5ICbTHWX1Sob4Vxh3AUq8_3525UftZoHOMky6CbS",
      "title": "刷题笔云端握笔优质手感考试必备学生专用初中高中考公考研考试神器 专业装48色丙烯马克笔套装",
      "short_title": "刷题笔云端握笔优质手感考试必备学生专用初中高中考公考研考试神器 专业装48色丙烯马克笔套装",
      "price": 9.99,
      "coupon_price": 9.98,
      "commission_rate": 1.0,
      "commission_amount": 0.1,
      "main_image": "https://img14.360buyimg.com/pop/jfs/t20260624/298035/30/18091/471911/685985e4F29caff45/9c463c6bf5dd02f8.png",
      "category_name": "笔类/书写工具",
      "shop_name": "京喜自营官方店",
      "sales_volume": 6000,
      "coupon_info": "满10元减5元",
      "coupon_amount": 5.0,
      "profit_amount": 0.1,
      "created_at": "2025-07-20T11:07:17"
    }
  ]
}

## 二、商品搜索接口

### 2.1 智能商品搜索（支持平台区分）

**接口地址**: `GET /products`

**功能说明**: 在已保存的商品数据中进行智能搜索，**支持按平台精确搜索**，可以单独搜索淘宝或京东商品

**请求参数**:
| 参数名 | 类型 | 必填 | 默认值 | 说明 |
|--------|------|------|--------|------|
| page | int | 否 | 1 | 页码 |
| size | int | 否 | 20 | 每页数量，最大100 |
| platform | int | 否 | - | **平台筛选：1淘宝，2京东（重要参数）** |
| keyword | string | 否 | - | 关键词搜索（支持模糊匹配） |
| min_commission | float | 否 | - | 最低佣金比例 |
| status | int | 否 | 1 | 商品状态：1有效，0失效 |

**搜索特性**:
- ✅ **支持平台区分搜索** - 可单独搜索淘宝或京东商品
- ✅ 支持商品标题模糊匹配
- ✅ 支持多关键词组合搜索
- ✅ 自动按相关度和时间排序
- ✅ 实时过滤失效商品
- ✅ 支持佣金比例筛选

### 2.2 平台搜索示例

#### 2.2.1 搜索淘宝商品

**请求示例**:
```bash
# 搜索淘宝平台包含"手机"关键词的商品
curl -X GET "https://taokeapi.ymj520.top/api/v1/products?platform=1&keyword=%E6%89%8B%E6%9C%BA&page=1&size=3"
```

**响应示例**:
```json
{
  "data": [
    {
      "id": 177487,
      "platform": 1,
      "platform_name": "淘宝",
      "product_id": "bXMy7mo2Ugtokrp8qzzTNVpHgU6-pD26O6sRr0A2jwwU8",
      "title": "网红爆款吹泡泡的怪女孩美甲贴纸童趣搞怪穿戴甲饰品手机壳diy贴",
      "price": 5.9,
      "coupon_price": 5.9,
      "commission_rate": 4.5,
      "commission_amount": 0.27,
      "main_image": "https://img.alicdn.com/bao/uploaded/i4/2609866314/O1CN01joIPCE1wVrpVUWbCc_!!2609866314.jpg",
      "shop_name": "潮际美甲品牌直销店",
      "sales_volume": 200,
      "status": 1,
      "created_at": "2025-07-20 10:25:43"
    }
  ],
  "total": 296,
  "page": 1,
  "size": 3,
  "pages": 99
}
```

#### 2.2.2 搜索京东商品

**请求示例**:
```bash
# 搜索京东平台包含"手机"关键词的商品
curl -X GET "https://taokeapi.ymj520.top/api/v1/products?platform=2&keyword=%E6%89%8B%E6%9C%BA&page=1&size=3"
```

**响应示例**:
```json
{
  "data": [
    {
      "id": 186228,
      "platform": 2,
      "platform_name": "京东",
      "product_id": "XHV23YYmUKlanFBlv6BW22Q4_3HJs0Hm6SUHcITs9Yo",
      "title": "西部数据（WD）移动硬盘 USB3.0 Elements新元素系列2.5英寸机械硬盘 大容量 手机电脑外置外接 1TB 热卖款SE 官方标配",
      "price": 449.0,
      "coupon_price": 429.0,
      "commission_rate": 1.0,
      "commission_amount": 4.29,
      "main_image": "https://img14.360buyimg.com/pop/jfs/t1/304160/15/16648/163938/686f2739F46bc0375/237c1a5617530300.jpg",
      "shop_name": "西部数据官方旗舰店",
      "sales_volume": 1000,
      "status": 1,
      "created_at": "2025-07-20 11:07:17"
    }
  ],
  "total": 1174,
  "page": 1,
  "size": 3,
  "pages": 392
}
```

#### 2.2.3 按佣金比例搜索

**淘宝高佣金商品**:
```bash
# 搜索淘宝佣金率大于10%的商品
curl -X GET "https://taokeapi.ymj520.top/api/v1/products?platform=1&min_commission=10&page=1&size=3"
```

**京东高佣金商品**:
```bash
# 搜索京东佣金率大于5%的商品
curl -X GET "https://taokeapi.ymj520.top/api/v1/products?platform=2&min_commission=5&page=1&size=3"
```

### 2.3 全平台搜索

**请求示例**:
```bash
# 不指定platform参数，搜索所有平台的商品
curl -X GET "https://taokeapi.ymj520.top/api/v1/products?keyword=%E6%89%8B%E6%9C%BA&page=1&size=3"
```

**响应格式**:
```json
{
  "data": [
    {
      "id": 186228,
      "platform": 2,
      "platform_name": "京东",
      "product_id": "XHV23YYmUKlanFBlv6BW22Q4_3HJs0Hm6SUHcITs9Yo",
      "title": "西部数据（WD）移动硬盘 USB3.0 Elements新元素系列2.5英寸机械硬盘 大容量 手机电脑外置外接 1TB 热卖款SE 官方标配",
      "price": 449.0,
      "coupon_price": 429.0,
      "commission_rate": 1.0,
      "commission_amount": 4.29,
      "main_image": "https://img14.360buyimg.com/pop/jfs/t1/304160/15/16648/163938/686f2739F46bc0375/237c1a5617530300.jpg",
      "shop_name": "西部数据官方旗舰店",
      "sales_volume": 1000,
      "status": 1,
      "created_at": "2025-07-20 11:07:17"
    },
    {
      "id": 177487,
      "platform": 1,
      "platform_name": "淘宝",
      "product_id": "bXMy7mo2Ugtokrp8qzzTNVpHgU6-pD26O6sRr0A2jwwU8",
      "title": "网红爆款吹泡泡的怪女孩美甲贴纸童趣搞怪穿戴甲饰品手机壳diy贴",
      "price": 5.9,
      "coupon_price": 5.9,
      "commission_rate": 4.5,
      "commission_amount": 0.27,
      "main_image": "https://img.alicdn.com/bao/uploaded/i4/2609866314/O1CN01joIPCE1wVrpVUWbCc_!!2609866314.jpg",
      "shop_name": "潮际美甲品牌直销店",
      "sales_volume": 200,
      "status": 1,
      "created_at": "2025-07-20 10:25:43"
    }
  ],
  "total": 1470,
  "page": 1,
  "size": 3,
  "pages": 490
}
```

## 三、商品转链接口

### 3.1 单个商品转链

**接口地址**: `POST /products/{product_id}/convert`

**功能说明**: 将指定商品转换为推广链接，支持淘宝淘口令和京东短链

**路径参数**:
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| product_id | string | 是 | 商品ID |

**查询参数**:
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| platform | int | 是 | 平台类型：1淘宝，2京东 |

**请求示例**:
```bash
# 转换淘宝商品为推广链接
curl -X POST "https://taokeapi.ymj520.top/api/v1/products/DY3AZXviDt5r2mQN83cODdTyUn-zm32N2To0OjPx3gSO/convert?platform=1"
```

**响应格式**:
```json
{
  "message": "淘宝商品转链成功",
  "status": "success",
  "data": {
    "product_id": "5D7WpVbUxtyGv8xzneI8mRTOUV-zm32N2To0OjPx3gSO",
    "title": "直播美衣福利来袭【连衣裙专拍】孤品不退换谨慎下单！",
    "price": 299.0,
    "coupon_price": 299.0,
    "commission_rate": 4.5,
    "commission_amount": 13.46,
    "taokoling": "￥XGwk4dM9ik7￥",
    "coupon_click_url": "https://uland.taobao.com/coupon/edetail?e=w%2Foqjxx%2F17ClhHvvyUNXZfh8CuWt5YH5OVuOuRD5gLJMmdsrkidbOUV9IBA4kmjL82cr4jAF03yzU3RtoNKzC93%2BesXjK2ZSLG859EyI6W3hsQTbB0kTRQivSIw963q%2BXCf7dbablFZyBOK%2B8KjzSpbYYQPtGd%2FdoNiOiRwuqfYGUY3o88Pv6NOk31fpwieWJJf9fXs%2BmOXB5p3CLqTBbtWHnsfAKSxcyYw77BbAvuY8IUJY%2BNcFE7%2F3Rohhyv5bQqQCEips4HszA3dXUSjXiSOPepoxgdpuxvaugsCSIqNyZ3tf5nfJea5OaBGcL9GS%2FzrmtpFY67E%3D&traceId=210761ac17529831704118636e0a92&&union_lens=lensId:TAPI@1752983170@21279cf8_2804_19825f06dde_8f74@01",
    "item_url": "https://s.click.taobao.com/t?e=m%3D2%26s%3DZ839bL1VA9hw4vFB6t2Z2ueEDrYVVa64XoO8tOebS%2BdRAdhuF14FMVBtuiAGF1C%2BJ1gyddu7kN%2FXoOjEknZkZgQacPpECnPKJI8tj%2B7pN0H0igS1x4XwXYVwhIsr1DlAgb9ZeSZXs4r6GHwypKYGfn3smV5vaX%2BgzRD18rVfQC7Qi04ZWz7rmS2%2Fdw3%2FHzs4FyXrckAMjOiCqFRC3VUqNAy0FScb8AAF7YGeMqfcXB5C8CwUYkvBKJIYnGnPCmChalqEIlzsK3%2Fy4okwgjYwq7UxAgcvaao2Mkcob38Ft8Sg%2F%2FwBDhW7FSGFCzYOOqAQ&union_lens=lensId:TAPI@1752983170@21279cf8_2804_19825f06dde_8f74@01&relationId=",
    "short_url": "https://s.click.taobao.com/KtRweAr",
    "short_url2": "https://s.tb.cn/h.h93ZT5l",
    "coupon_info": "",
    "coupon_amount": 0.0,
    "coupon_start_time": "",
    "coupon_end_time": "",
    "main_image": "https://img.alicdn.com/bao/uploaded/i1/644620578/O1CN017xvxCi1G8lqcPcdhs_!!644620578.png",
    "shop_name": "FreshMany",
    "sales_volume": 2000,
    "platform": "淘宝",
    "taobao_command": "【淘宝】【299.0元】直播美衣福利来袭【连衣裙专拍】孤品不退换谨慎下单！ https://s.click.taobao.com/KtRweAr ￥XGwk4dM9ik7￥\n点击复制按钮后\n打开淘宝APP直接购买"
  }
}
```

### 3.2 批量商品转链

**接口地址**: `POST /products/convert/batch`

**功能说明**: 批量转换多个商品为推广链接，最多支持20个商品

**请求体**:
```json
{
  "product_ids": ["123456789", "987654321", "456789123"],
  "platform": 1
}
```

**请求示例**:
```bash
# 批量转换淘宝商品
curl -X POST "https://taokeapi.ymj520.top/api/v1/products/convert/batch" \
  -H "Content-Type: application/json" \
  -d '{
    "product_ids": ["DY3AZXviDt5r2mQN83cODdTyUn-zm32N2To0OjPx3gSO", "g6PxyvzC3t2yWJOVBbH249ibUr-0gwWdWsBmBryBw8Tx"],
    "platform": 1
  }'
```

**响应格式**:
```json
{
  "message": "批量转链完成，成功2个，失败0个",
  "status": "success",
  "data": {
    "total": 2,
    "success_count": 2,
    "failed_count": 0,
    "results": [
      {
        "product_id": "DY3AZXviDt5r2mQN83cODdTyUn-zm32N2To0OjPx3gSO",
        "result": {
          "success": true,
          "message": "淘宝商品转链成功",
          "data": {
            "product_id": "5D7WpVbUxtyGv8xzneI8mRTOUV-zm32N2To0OjPx3gSO",
            "title": "直播美衣福利来袭【连衣裙专拍】孤品不退换谨慎下单！",
            "price": 299.0,
            "coupon_price": 299.0,
            "commission_rate": 4.5,
            "commission_amount": 13.46,
            "taokoling": "￥XGwk4dM9ik7￥",
            "short_url": "https://s.click.taobao.com/KtRweAr",
            "short_url2": "https://s.tb.cn/h.h93ZT5l",
            "taobao_command": "【淘宝】【299.0元】直播美衣福利来袭【连衣裙专拍】孤品不退换谨慎下单！ https://s.click.taobao.com/KtRweAr ￥XGwk4dM9ik7￥\n点击复制按钮后\n打开淘宝APP直接购买"
          }
        }
      }
    ]
  }
}
```

### 3.3 专用转链接口

#### 3.3.1 生成淘口令

**接口地址**: `POST /external/taobao/taokoling`

**功能说明**: 专门为淘宝商品生成淘口令

**请求体**:
```json
{
  "product_id": "DY3AZXviDt5r2mQN83cODdTyUn-zm32N2To0OjPx3gSO"
}
```

**请求示例**:
```bash
curl -X POST "https://taokeapi.ymj520.top/api/v1/external/taobao/taokoling" \
  -H "Content-Type: application/json" \
  -d '{"product_id":"DY3AZXviDt5r2mQN83cODdTyUn-zm32N2To0OjPx3gSO"}'
```

**响应格式**:
```json
{
  "success": true,
  "message": "淘口令生成成功",
  "data": {
    "product_id": "DY3AZXviDt5r2mQN83cODdTyUn-zm32N2To0OjPx3gSO",
    "taokoling": "",
    "promotion_url": "",
    "short_url": "https://s.click.taobao.com/KtRweAr",
    "title": "直播美衣福利来袭【连衣裙专拍】孤品不退换谨慎下单！",
    "price": 299.0,
    "coupon_price": 299.0,
    "commission_rate": 4.5,
    "commission_amount": 13.46,
    "coupon_info": "",
    "main_image": "https://img.alicdn.com/bao/uploaded/i1/644620578/O1CN017xvxCi1G8lqcPcdhs_!!644620578.png"
  }
}
```

#### 3.3.2 生成京东短链

**接口地址**: `POST /external/jd/shortlink`

**功能说明**: 专门为京东商品生成短链接

**请求体**:
```json
{
  "product_id": "jvZ5ICbTHWX1Sob4Vxh3AUq8_3525UftZoHOMky6CbS"
}
```

**请求示例**:
```bash
curl -X POST "https://taokeapi.ymj520.top/api/v1/external/jd/shortlink" \
  -H "Content-Type: application/json" \
  -d '{"product_id":"jvZ5ICbTHWX1Sob4Vxh3AUq8_3525UftZoHOMky6CbS"}'
```

**响应格式**:
```json
{
  "success": true,
  "message": "京东短链生成成功",
  "data": {
    "product_id": "jvZ5ICbTHWX1Sob4Vxh3AUq8_3525UftZoHOMky6CbS",
    "short_url": "https://u.jd.com/ngUqShG",
    "jd_command": "【京东】https://u.jd.com/ngUqShG 「【补贴价￥9.98，已补￥0.01】刷题笔云端握笔优质手感考试必备学生专用初中高中考公考研考试神器 专业装48色丙烯马克笔套装」\n点击链接直接打开",
    "promotion_url": "",
    "title": "刷题笔云端握笔优质手感考试必备学生专用初中高中考公考研考试神器 专业装48色丙烯马克笔套装",
    "price": 9.99,
    "coupon_price": 9.98,
    "commission_rate": 1.0,
    "commission_amount": 0.1,
    "coupon_info": "满10元减5元",
    "main_image": "https://img14.360buyimg.com/pop/jfs/t20260624/298035/30/18091/471911/685985e4F29caff45/9c463c6bf5dd02f8.png"
  }
}
```

#### 3.3.3 批量转换接口

**接口地址**: `POST /external/convert/batch`

**功能说明**: 外部系统专用的批量转换接口

**请求体**:
```json
{
  "product_ids": ["DY3AZXviDt5r2mQN83cODdTyUn-zm32N2To0OjPx3gSO", "g6PxyvzC3t2yWJOVBbH249ibUr-0gwWdWsBmBryBw8Tx"],
  "platform": 1
}
```

**请求示例**:
```bash
curl -X POST "https://taokeapi.ymj520.top/api/v1/external/convert/batch" \
  -H "Content-Type: application/json" \
  -d '{
    "product_ids": ["DY3AZXviDt5r2mQN83cODdTyUn-zm32N2To0OjPx3gSO", "g6PxyvzC3t2yWJOVBbH249ibUr-0gwWdWsBmBryBw8Tx"],
    "platform": 1
  }'
```

**响应格式**:
```json
{
  "success": true,
  "message": "淘宝批量转链完成，成功2个，失败0个",
  "total": 2,
  "success_count": 2,
  "failed_count": 0,
  "data": [
    {
      "product_id": "DY3AZXviDt5r2mQN83cODdTyUn-zm32N2To0OjPx3gSO",
      "result": {
        "success": true,
        "message": "淘宝商品转链成功",
        "data": {
          "product_id": "5D7WpVbUxtyGv8xzneI8mRTOUV-zm32N2To0OjPx3gSO",
          "title": "直播美衣福利来袭【连衣裙专拍】孤品不退换谨慎下单！",
          "taokoling": "￥XGwk4dM9ik7￥",
          "short_url": "https://s.click.taobao.com/KtRweAr",
          "commission_amount": 13.46,
          "taobao_command": "【淘宝】【299.0元】直播美衣福利来袭【连衣裙专拍】孤品不退换谨慎下单！ https://s.click.taobao.com/KtRweAr ￥XGwk4dM9ik7￥\n点击复制按钮后\n打开淘宝APP直接购买"
        }
      }
    }
  ]
}
```

## 四、数据字段说明

### 4.1 商品数据字段

| 字段名 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| id | int | 系统内部商品ID | 196055 |
| platform | int | 平台ID：1淘宝，2京东 | 1 |
| platform_name | string | 平台名称 | "淘宝" |
| product_id | string | 商品在平台的ID（系统生成的唯一标识） | "DY3AZXviDt5r2mQN83cODdTyUn-zm32N2To0OjPx3gSO" |
| title | string | 商品完整标题 | "直播美衣福利来袭【连衣裙专拍】孤品不退换谨慎下单！" |
| short_title | string | 商品短标题 | "直播美衣福利来袭【连衣裙专拍】孤品不退换谨慎下单！" |
| price | float | 商品原价 | 299.0 |
| coupon_price | float | 使用优惠券后价格 | 299.0 |
| commission_rate | float | 佣金比例（%） | 4.5 |
| commission_amount | float | 佣金金额 | 13.46 |
| main_image | string | 商品主图URL | "https://img.alicdn.com/bao/uploaded/i1/644620578/O1CN017xvxCi1G8lqcPcdhs_!!644620578.png" |
| shop_name | string | 店铺名称 | "FreshMany" |
| sales_volume | int | 销量 | 2000 |
| coupon_info | string | 优惠券描述 | "满0元减0元" |
| coupon_amount | float | 优惠券金额 | 0.0 |
| category_name | string | 分类名称 | "毛呢外套" |
| profit_amount | float | 预估收益（佣金金额） | 13.46 |
| status | int | 商品状态：1有效，0失效 | 1 |
| created_at | string | 数据采集时间 | "2025-07-20T11:45:11" |

**注意事项**:
- `product_id` 是系统生成的唯一标识符，不是商品在原平台的ID
- 淘宝和京东的字段略有差异，京东商品可能包含额外的促销信息
- `profit_amount` 等于 `commission_amount`，表示预估收益

### 4.2 转链结果字段

#### 淘宝转链字段
| 字段名 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| product_id | string | 商品ID | "5D7WpVbUxtyGv8xzneI8mRTOUV-zm32N2To0OjPx3gSO" |
| title | string | 商品标题 | "直播美衣福利来袭【连衣裙专拍】孤品不退换谨慎下单！" |
| price | float | 商品原价 | 299.0 |
| coupon_price | float | 券后价 | 299.0 |
| commission_rate | float | 佣金比例（%） | 4.5 |
| commission_amount | float | 佣金金额 | 13.46 |
| taokoling | string | 淘口令 | "￥XGwk4dM9ik7￥" |
| short_url | string | 短链接 | "https://s.click.taobao.com/KtRweAr" |
| short_url2 | string | 备用短链接 | "https://s.tb.cn/h.h93ZT5l" |
| item_url | string | 完整推广链接 | "https://s.click.taobao.com/t?e=m%3D2%26s%3D..." |
| coupon_click_url | string | 优惠券链接 | "https://uland.taobao.com/coupon/edetail?e=..." |
| taobao_command | string | 淘宝分享文案 | "【淘宝】【299.0元】直播美衣福利来袭..." |
| main_image | string | 商品主图 | "https://img.alicdn.com/bao/uploaded/..." |
| shop_name | string | 店铺名称 | "FreshMany" |
| sales_volume | int | 销量 | 2000 |

#### 京东转链字段
| 字段名 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| product_id | string | 商品ID | "jvZ5ICbTHWX1Sob4Vxh3AUq8_3525UftZoHOMky6CbS" |
| title | string | 商品标题 | "刷题笔云端握笔优质手感考试必备..." |
| price | float | 商品原价 | 9.99 |
| coupon_price | float | 券后价 | 9.98 |
| commission_rate | float | 佣金比例（%） | 1.0 |
| commission_amount | float | 佣金金额 | 0.1 |
| short_url | string | 京东短链接 | "https://u.jd.com/ngUqShG" |
| jd_command | string | 京东分享文案 | "【京东】https://u.jd.com/ngUqShG 「【补贴价￥9.98..." |
| promotion_url | string | 推广链接（可能为空） | "" |
| coupon_info | string | 优惠券信息 | "满10元减5元" |
| main_image | string | 商品主图 | "https://img14.360buyimg.com/pop/jfs/..." |

## 五、错误处理

### 5.1 HTTP状态码

| 状态码 | 说明 |
|--------|------|
| 200 | 请求成功 |
| 400 | 请求参数错误 |
| 404 | 资源不存在 |
| 429 | 请求频率过高 |
| 500 | 服务器内部错误 |

### 5.2 错误响应格式

```json
{
  "success": false,
  "message": "错误描述信息",
  "error_code": "ERROR_CODE",
  "timestamp": "2024-01-01T12:00:00Z"
}
```

### 5.3 常见错误

| 错误码 | 说明 | 解决方案 |
|--------|------|----------|
| PRODUCT_NOT_FOUND | 商品不存在 | 检查商品ID是否正确 |
| PRODUCT_OFFLINE | 商品已下架 | 使用其他有效商品 |
| CONVERT_FAILED | 转链失败 | 检查商品状态和配置 |
| RATE_LIMIT_EXCEEDED | 请求频率过高 | 降低请求频率 |
| INVALID_PLATFORM | 不支持的平台 | 使用支持的平台ID |

## 六、使用限制

### 6.1 请求限制

- **请求频率**: 每分钟最多100次请求
- **批量操作**: 批量转链最多20个商品
- **分页限制**: 每页最多100条记录
- **搜索限制**: 关键词长度不超过50字符

### 6.2 数据更新

- **商品数据**: 每5分钟自动更新一次
- **失效检查**: 每24小时检查一次商品有效性
- **价格更新**: 实时同步平台价格变化
- **库存状态**: 自动过滤无库存商品

## 七、集成示例

### 7.1 Python集成示例

```python
import requests
import json

class TaokeAPI:
    def __init__(self, base_url="https://taokeapi.ymj520.top/api/v1"):
        self.base_url = base_url
        self.session = requests.Session()
        self.session.headers.update({
            'Content-Type': 'application/json',
            'Accept': 'application/json'
        })

    def search_products(self, keyword=None, platform=None, page=1, size=20, min_commission=None):
        """
        搜索商品（支持平台区分）

        Args:
            keyword: 关键词搜索
            platform: 平台筛选（1淘宝，2京东，None为全平台）
            page: 页码
            size: 每页数量
            min_commission: 最低佣金比例
        """
        url = f"{self.base_url}/products"
        params = {
            "page": page,
            "size": size
        }

        if keyword:
            params["keyword"] = keyword
        if platform:
            params["platform"] = platform
        if min_commission:
            params["min_commission"] = min_commission

        response = self.session.get(url, params=params)
        return response.json()

    def search_taobao_products(self, keyword=None, page=1, size=20, min_commission=None):
        """专门搜索淘宝商品"""
        return self.search_products(keyword=keyword, platform=1, page=page, size=size, min_commission=min_commission)

    def search_jd_products(self, keyword=None, page=1, size=20, min_commission=None):
        """专门搜索京东商品"""
        return self.search_products(keyword=keyword, platform=2, page=page, size=size, min_commission=min_commission)

    def get_all_products(self, page=1, page_size=20, **filters):
        """获取全平台商品"""
        url = f"{self.base_url}/external/products/all"
        params = {"page": page, "page_size": page_size, **filters}
        response = self.session.get(url, params=params)
        return response.json()

    def get_taobao_products(self, page=1, page_size=20, **filters):
        """获取淘宝商品"""
        url = f"{self.base_url}/external/products/taobao"
        params = {"page": page, "page_size": page_size, **filters}
        response = self.session.get(url, params=params)
        return response.json()

    def get_jd_products(self, page=1, page_size=20, **filters):
        """获取京东商品"""
        url = f"{self.base_url}/external/products/jd"
        params = {"page": page, "page_size": page_size, **filters}
        response = self.session.get(url, params=params)
        return response.json()

    def convert_single_product(self, product_id, platform):
        """单个商品转链"""
        url = f"{self.base_url}/products/{product_id}/convert"
        params = {"platform": platform}
        response = self.session.post(url, params=params)
        return response.json()

    def convert_batch_products(self, product_ids, platform):
        """批量商品转链"""
        url = f"{self.base_url}/products/convert/batch"
        data = {
            "product_ids": product_ids,
            "platform": platform
        }
        response = self.session.post(url, json=data)
        return response.json()

    def generate_taokoling(self, product_id):
        """生成淘口令"""
        url = f"{self.base_url}/external/taobao/taokoling"
        data = {"product_id": product_id}
        response = self.session.post(url, json=data)
        return response.json()

    def generate_jd_shortlink(self, product_id):
        """生成京东短链"""
        url = f"{self.base_url}/external/jd/shortlink"
        data = {"product_id": product_id}
        response = self.session.post(url, json=data)
        return response.json()

    def batch_convert_external(self, product_ids, platform):
        """外部批量转换接口"""
        url = f"{self.base_url}/external/convert/batch"
        data = {
            "product_ids": product_ids,
            "platform": platform
        }
        response = self.session.post(url, json=data)
        return response.json()

# 使用示例
if __name__ == "__main__":
    api = TaokeAPI()

    # 1. 获取全平台商品
    all_products = api.get_all_products(page=1, page_size=5)
    print(f"全平台商品总数: {all_products['total']}")

    # 2. 平台搜索示例
    # 搜索淘宝手机商品
    taobao_search = api.search_taobao_products("手机", page=1, size=3)
    print(f"淘宝搜索到 {taobao_search['total']} 个手机相关商品")

    # 搜索京东手机商品
    jd_search = api.search_jd_products("手机", page=1, size=3)
    print(f"京东搜索到 {jd_search['total']} 个手机相关商品")

    # 搜索全平台手机商品
    all_search = api.search_products("手机", page=1, size=3)
    print(f"全平台搜索到 {all_search['total']} 个手机相关商品")

    # 搜索淘宝高佣金商品
    high_commission_taobao = api.search_taobao_products(min_commission=10, page=1, size=3)
    print(f"淘宝高佣金商品: {high_commission_taobao['total']} 个")

    # 搜索京东高佣金商品
    high_commission_jd = api.search_jd_products(min_commission=5, page=1, size=3)
    print(f"京东高佣金商品: {high_commission_jd['total']} 个")

    # 3. 获取淘宝商品并转链
    taobao_products = api.get_taobao_products(page=1, page_size=2)
    if taobao_products["success"] and taobao_products["data"]:
        product = taobao_products["data"][0]
        product_id = product["product_id"]

        # 生成淘口令
        taokoling_result = api.generate_taokoling(product_id)
        if taokoling_result["success"]:
            print(f"淘口令生成成功: {taokoling_result['data']['short_url']}")

    # 4. 获取京东商品并转链
    jd_products = api.get_jd_products(page=1, page_size=2)
    if jd_products["success"] and jd_products["data"]:
        product = jd_products["data"][0]
        product_id = product["product_id"]

        # 生成京东短链
        shortlink_result = api.generate_jd_shortlink(product_id)
        if shortlink_result["success"]:
            print(f"京东短链生成成功: {shortlink_result['data']['short_url']}")

    # 5. 批量转链示例
    if all_products["success"] and len(all_products["data"]) >= 2:
        # 获取前两个淘宝商品ID
        taobao_ids = [p["product_id"] for p in all_products["data"] if p["platform"] == 1][:2]
        if taobao_ids:
            batch_result = api.batch_convert_external(taobao_ids, platform=1)
            if batch_result["success"]:
                print(f"批量转链成功: {batch_result['success_count']} 个商品")
```

### 7.2 JavaScript集成示例

```javascript
class TaokeAPI {
    constructor(baseUrl = 'https://taokeapi.ymj520.top/api/v1') {
        this.baseUrl = baseUrl;
        this.headers = {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
        };
    }

    async searchProducts(keyword = null, platform = null, page = 1, size = 20, minCommission = null) {
        /**
         * 搜索商品（支持平台区分）
         * @param {string} keyword - 关键词搜索
         * @param {number} platform - 平台筛选（1淘宝，2京东，null为全平台）
         * @param {number} page - 页码
         * @param {number} size - 每页数量
         * @param {number} minCommission - 最低佣金比例
         */
        const params = new URLSearchParams({
            page,
            size
        });

        if (keyword) {
            params.append('keyword', keyword);
        }
        if (platform) {
            params.append('platform', platform);
        }
        if (minCommission) {
            params.append('min_commission', minCommission);
        }

        const response = await fetch(`${this.baseUrl}/products?${params}`);
        return await response.json();
    }

    async searchTaobaoProducts(keyword = null, page = 1, size = 20, minCommission = null) {
        /**专门搜索淘宝商品*/
        return await this.searchProducts(keyword, 1, page, size, minCommission);
    }

    async searchJdProducts(keyword = null, page = 1, size = 20, minCommission = null) {
        /**专门搜索京东商品*/
        return await this.searchProducts(keyword, 2, page, size, minCommission);
    }

    async getAllProducts(page = 1, pageSize = 20, filters = {}) {
        const params = new URLSearchParams({
            page,
            page_size: pageSize,
            ...filters
        });

        const response = await fetch(`${this.baseUrl}/external/products/all?${params}`);
        return await response.json();
    }

    async getTaobaoProducts(page = 1, pageSize = 20, filters = {}) {
        const params = new URLSearchParams({
            page,
            page_size: pageSize,
            ...filters
        });

        const response = await fetch(`${this.baseUrl}/external/products/taobao?${params}`);
        return await response.json();
    }

    async getJdProducts(page = 1, pageSize = 20, filters = {}) {
        const params = new URLSearchParams({
            page,
            page_size: pageSize,
            ...filters
        });

        const response = await fetch(`${this.baseUrl}/external/products/jd?${params}`);
        return await response.json();
    }

    async convertSingleProduct(productId, platform) {
        const params = new URLSearchParams({ platform });
        const response = await fetch(`${this.baseUrl}/products/${productId}/convert?${params}`, {
            method: 'POST'
        });
        return await response.json();
    }

    async convertBatchProducts(productIds, platform) {
        const response = await fetch(`${this.baseUrl}/products/convert/batch`, {
            method: 'POST',
            headers: this.headers,
            body: JSON.stringify({
                product_ids: productIds,
                platform
            })
        });
        return await response.json();
    }

    async generateTaokoling(productId) {
        const response = await fetch(`${this.baseUrl}/external/taobao/taokoling`, {
            method: 'POST',
            headers: this.headers,
            body: JSON.stringify({
                product_id: productId
            })
        });
        return await response.json();
    }

    async generateJdShortlink(productId) {
        const response = await fetch(`${this.baseUrl}/external/jd/shortlink`, {
            method: 'POST',
            headers: this.headers,
            body: JSON.stringify({
                product_id: productId
            })
        });
        return await response.json();
    }

    async batchConvertExternal(productIds, platform) {
        const response = await fetch(`${this.baseUrl}/external/convert/batch`, {
            method: 'POST',
            headers: this.headers,
            body: JSON.stringify({
                product_ids: productIds,
                platform
            })
        });
        return await response.json();
    }
}

// 使用示例
(async () => {
    const api = new TaokeAPI();

    try {
        // 1. 获取全平台商品
        const allProducts = await api.getAllProducts(1, 5);
        console.log(`全平台商品总数: ${allProducts.total}`);

        // 2. 平台搜索示例
        // 搜索淘宝手机商品
        const taobaoSearch = await api.searchTaobaoProducts('手机', 1, 3);
        console.log(`淘宝搜索到 ${taobaoSearch.total} 个手机相关商品`);

        // 搜索京东手机商品
        const jdSearch = await api.searchJdProducts('手机', 1, 3);
        console.log(`京东搜索到 ${jdSearch.total} 个手机相关商品`);

        // 搜索全平台手机商品
        const allSearch = await api.searchProducts('手机', null, 1, 3);
        console.log(`全平台搜索到 ${allSearch.total} 个手机相关商品`);

        // 搜索淘宝高佣金商品
        const highCommissionTaobao = await api.searchTaobaoProducts(null, 1, 3, 10);
        console.log(`淘宝高佣金商品: ${highCommissionTaobao.total} 个`);

        // 搜索京东高佣金商品
        const highCommissionJd = await api.searchJdProducts(null, 1, 3, 5);
        console.log(`京东高佣金商品: ${highCommissionJd.total} 个`);

        // 3. 获取淘宝商品并转链
        const taobaoProducts = await api.getTaobaoProducts(1, 2);
        if (taobaoProducts.success && taobaoProducts.data.length > 0) {
            const productId = taobaoProducts.data[0].product_id;

            // 生成淘口令
            const taokolingResult = await api.generateTaokoling(productId);
            if (taokolingResult.success) {
                console.log(`淘口令生成成功: ${taokolingResult.data.short_url}`);
            }
        }

        // 4. 获取京东商品并转链
        const jdProducts = await api.getJdProducts(1, 2);
        if (jdProducts.success && jdProducts.data.length > 0) {
            const productId = jdProducts.data[0].product_id;

            // 生成京东短链
            const shortlinkResult = await api.generateJdShortlink(productId);
            if (shortlinkResult.success) {
                console.log(`京东短链生成成功: ${shortlinkResult.data.short_url}`);
            }
        }

        // 5. 批量转链示例
        if (allProducts.success && allProducts.data.length >= 2) {
            // 获取前两个淘宝商品ID
            const taobaoIds = allProducts.data
                .filter(p => p.platform === 1)
                .slice(0, 2)
                .map(p => p.product_id);

            if (taobaoIds.length > 0) {
                const batchResult = await api.batchConvertExternal(taobaoIds, 1);
                if (batchResult.success) {
                    console.log(`批量转链成功: ${batchResult.success_count} 个商品`);
                }
            }
        }

    } catch (error) {
        console.error('API调用失败:', error);
    }
})();
```

## 八、最佳实践

### 8.1 性能优化建议

1. **使用分页查询**: 避免一次性获取大量数据
2. **合理使用筛选**: 通过筛选条件减少数据传输
3. **批量操作**: 优先使用批量接口处理多个商品
4. **缓存结果**: 对不经常变化的数据进行本地缓存

### 8.2 错误处理建议

1. **实现重试机制**: 对临时性错误进行重试
2. **记录详细日志**: 便于问题排查和分析
3. **优雅降级**: 当服务不可用时提供备选方案
4. **监控告警**: 及时发现和处理异常情况

### 8.3 安全建议

1. **输入验证**: 对所有输入参数进行验证
2. **频率控制**: 遵守API调用频率限制
3. **异常处理**: 妥善处理各种异常情况
4. **日志脱敏**: 避免在日志中记录敏感信息

## 九、平台搜索功能详解

### 9.1 为什么需要平台区分搜索？

1. **不同平台特性**:
   - 淘宝：佣金率通常较高（3%-45%），商品种类丰富，适合个人推广
   - 京东：商品质量稳定，物流快速，佣金率相对较低（1%-20%），适合企业采购

2. **用户需求差异**:
   - 有些用户只想推广淘宝商品（因为佣金高）
   - 有些用户只想推广京东商品（因为品质有保障）
   - 有些用户需要对比两个平台的同类商品

3. **转链方式不同**:
   - 淘宝：生成淘口令，用户复制后打开淘宝APP
   - 京东：生成短链接，用户点击直接跳转

### 9.2 平台搜索的优势

| 搜索方式 | 优势 | 适用场景 |
|----------|------|----------|
| 淘宝搜索 (`platform=1`) | 高佣金商品多，种类丰富 | 个人推广，追求高收益 |
| 京东搜索 (`platform=2`) | 品质保障，物流快速 | 企业采购，注重品质 |
| 全平台搜索 (不指定platform) | 商品选择最多，可对比 | 寻找最优商品，价格对比 |

### 9.3 搜索策略建议

```bash
# 策略1：高佣金优先（推荐淘宝）
curl -X GET "https://taokeapi.ymj520.top/api/v1/products?platform=1&min_commission=10&size=20"

# 策略2：品质优先（推荐京东）
curl -X GET "https://taokeapi.ymj520.top/api/v1/products?platform=2&keyword=%E5%93%81%E7%89%8C&size=20"

# 策略3：全面对比（全平台搜索）
curl -X GET "https://taokeapi.ymj520.top/api/v1/products?keyword=%E6%89%8B%E6%9C%BA&size=20"
```

### 9.4 实际数据对比

根据当前系统数据统计：

| 平台 | 商品总数 | 平均佣金率 | 高佣金商品数量(>10%) | 搜索"手机"结果 |
|------|----------|------------|---------------------|----------------|
| 淘宝 | 174,161 | 8.5% | 13,537 | 296个 |
| 京东 | 43,061 | 3.2% | 10,461 | 1,174个 |

**结论**：
- 淘宝商品数量更多，佣金率更高
- 京东在某些品类（如数码产品）商品更丰富
- 建议根据推广目标选择合适的平台

## 十、重要注意事项

### 10.1 商品ID说明
- 系统中的 `product_id` 是经过编码的唯一标识符，不是商品在原平台的ID
- 每个商品的 `product_id` 在系统中是唯一的，可以直接用于转链操作
- 不同时间采集的同一商品可能有不同的 `product_id`

### 10.2 数据更新频率
- **商品数据**: 系统每5分钟自动采集新商品
- **价格更新**: 商品价格和库存状态实时同步
- **失效检查**: 每24小时自动清理失效商品
- **当前数据量**: 淘宝174,161个商品，京东43,061个商品

### 10.3 转链成功率
- **淘宝转链**: 成功率约95%，主要失败原因是商品下架
- **京东转链**: 成功率约90%，部分商品可能不支持推广
- **建议**: 转链失败时可尝试其他相似商品

### 10.4 API限制
- **请求频率**: 建议每秒不超过10次请求
- **批量操作**: 批量转链建议每次不超过20个商品
- **超时时间**: 单次请求超时时间为30秒
- **并发限制**: 建议同时并发请求不超过5个

### 10.5 平台搜索最佳实践
1. **明确目标**: 根据推广目标选择合适的平台
2. **佣金优先**: 淘宝平台通常有更高的佣金率
3. **品质优先**: 京东平台商品质量更有保障
4. **组合使用**: 可以同时使用多个平台的商品进行推广

### 10.6 错误处理建议
1. **网络错误**: 实现重试机制，建议3次重试
2. **商品不存在**: 可尝试搜索相似商品替代
3. **转链失败**: 检查商品状态，选择其他有效商品
4. **频率限制**: 降低请求频率，增加请求间隔

## 十一、联系方式

- **API地址**: https://taokeapi.ymj520.top/api/v1
- **文档版本**: v2.0
- **最后更新**: 2025-07-20
- **数据统计**: 淘宝商品174,161个，京东商品43,061个
- **技术支持**: 如有问题请联系技术团队

## 十二、更新日志

### v2.1 (2025-07-20)
- **重点更新**：强化平台区分搜索功能
- 添加详细的平台搜索示例和说明
- 新增淘宝/京东专用搜索方法
- 添加平台搜索策略建议
- 提供实际数据对比分析
- 完善Python和JavaScript的平台搜索示例

### v2.0 (2025-07-20)
- 基于实际API测试更新所有接口文档
- 添加真实的请求和响应示例
- 更新商品数据字段说明
- 完善Python和JavaScript集成示例
- 添加快速开始指南

### v1.0 (2024-01-01)
- 初始版本发布
- 基础API接口文档
```
