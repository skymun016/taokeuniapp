# 新淘客API集成说明

## 概述

本次更新将原有的京东和淘宝页面升级为使用新的淘客API，实现了统一的商品搜索和转链功能。新API支持平台区分搜索，提供更丰富的商品信息和更稳定的服务。

## 新API特点

### API基础信息
- **基础URL**: `https://taokeapi.ymj520.top/api/v1`
- **支持平台**: 淘宝(platform=1)、京东(platform=2)、拼多多(platform=3)
- **商品数量**: 淘宝174,161个，京东43,061个

### 主要功能
1. **统一搜索接口**: 支持关键词搜索、平台筛选、佣金筛选
2. **平台专用接口**: 分别获取淘宝、京东商品列表
3. **转链功能**: 淘宝生成淘口令，京东生成短链
4. **批量处理**: 支持批量商品转链

## 文件修改清单

### 1. 新增文件

#### `common/newTaokeApi.js`
- 新淘客API的完整封装
- 包含所有接口调用方法
- 提供工具函数用于数据格式化
- 统一的错误处理和加载提示

#### `pages/newTaokeTest/newTaokeTest.vue`
- API测试页面
- 可测试所有主要接口功能
- 用于验证API连接和数据返回

### 2. 修改文件

#### `pages/dataokeGoodsList/dataokeGoodsList.vue` (淘宝商品列表)
**新增功能**:
- 搜索栏：支持关键词搜索，实时搜索和延迟搜索
- 筛选栏：全部商品、高佣金、价格排序
- 统计信息：显示总商品数、当前显示数、平均佣金率
- 商品卡片：显示平台标识、优惠券标识、佣金信息、商品标签

**API更新**:
- 使用 `newTaokeApi.request.searchProducts()` 进行搜索
- 平台参数设置为 `platform=1` (淘宝)
- 适配新的数据字段结构

#### `pages/jdHotGoodsList/jdHotGoodsList.vue` (京东商品列表)
**新增功能**:
- 与淘宝页面相同的搜索和筛选功能
- 京东橙色主题配色
- 统计信息和商品标签

**API更新**:
- 使用 `newTaokeApi.request.searchProducts()` 进行搜索
- 平台参数设置为 `platform=2` (京东)
- 适配新的数据字段结构

#### `pages/dataokeGoodsDetail/dataokeGoodsDetail.vue` (淘宝商品详情)
**功能更新**:
- 支持平台参数传递
- 使用新的转链API
- 根据平台显示不同的购买方式

**API更新**:
- 使用搜索API获取商品详情
- 淘宝使用 `generateTaokoling()` 生成淘口令
- 京东使用 `generateJdShortlink()` 生成短链

#### `pages.json`
- 添加新的测试页面路由配置

## 数据结构变化

### 新API商品数据字段
```javascript
{
  product_id: "商品ID",
  title: "商品标题",
  short_title: "短标题",
  main_image: "主图URL",
  price: "原价",
  coupon_price: "券后价",
  coupon_amount: "优惠券金额",
  commission_rate: "佣金比例",
  commission_amount: "佣金金额",
  sales_volume: "销量",
  shop_name: "店铺名称",
  platform: "平台ID(1淘宝2京东)"
}
```

### 转链数据字段
**淘宝转链**:
```javascript
{
  taokoling: "淘口令",
  short_url: "短链接",
  taobao_command: "完整购买文案"
}
```

**京东转链**:
```javascript
{
  short_url: "短链接",
  jd_command: "完整购买文案"
}
```

## 新功能特性

### 1. 搜索功能
- **实时搜索**: 输入关键词后延迟500ms自动搜索
- **搜索确认**: 点击搜索按钮或回车确认搜索
- **搜索清除**: 一键清除搜索关键词

### 2. 筛选功能
- **全部商品**: 显示所有商品
- **高佣金**: 淘宝佣金≥10%，京东佣金≥5%
- **价格排序**: 支持价格升序和降序

### 3. 统计信息
- **总商品数**: 显示平台商品总数
- **当前显示**: 显示当前页面商品数量
- **平均佣金**: 计算当前商品的平均佣金率

### 4. 商品标签
- **高佣金标签**: 佣金率较高的商品
- **有券标签**: 有优惠券的商品
- **热销标签**: 销量较高的商品

### 5. 平台标识
- 商品卡片左上角显示平台标识
- 右上角显示优惠券金额（如有）
- 价格下方显示佣金信息

## 使用方法

### 1. 测试API连接
访问 `pages/newTaokeTest/newTaokeTest` 页面，测试各个API接口是否正常工作。

### 2. 商品搜索
1. 在商品列表页面输入关键词
2. 选择筛选条件
3. 查看搜索结果和统计信息

### 3. 商品转链
1. 点击商品进入详情页
2. 点击"领取优惠"按钮
3. 系统自动转链并显示购买信息

## 技术要点

### 1. API封装
- 统一的请求方法和错误处理
- 自动加载提示和超时处理
- 平台参数自动设置

### 2. 数据适配
- 新旧数据字段映射
- 价格和佣金格式化
- 销量数字格式化

### 3. UI优化
- 响应式布局设计
- 现代化卡片样式
- 渐变色彩搭配

### 4. 性能优化
- 搜索防抖处理
- 分页加载更多
- 图片懒加载

## 注意事项

1. **API兼容性**: 新API可能与旧版本数据结构不完全兼容，已做适配处理
2. **网络超时**: API请求超时时间设置为15秒，可根据需要调整
3. **错误处理**: 所有API调用都有完善的错误处理和用户提示
4. **平台区分**: 确保在调用API时正确设置platform参数

## 后续优化建议

1. **缓存机制**: 添加商品数据缓存，减少重复请求
2. **图片优化**: 实现图片懒加载和压缩
3. **搜索历史**: 保存用户搜索历史记录
4. **个性化推荐**: 基于用户行为推荐商品
5. **数据统计**: 添加更详细的数据分析功能

## 联系方式

如有问题或建议，请联系开发团队。
